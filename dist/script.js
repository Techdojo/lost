function SfxrParams(){this.setSettings=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var s=this.b+this.c+this.e;if(s<.18){var i=.18/s;this.b*=i,this.c*=i,this.e*=i}}}function SfxrSynth(){this._params=new SfxrParams;var t,e,s,i,o,r,n,h,a,c,p,d;this.reset=function(){var t=this._params;i=100/(t.f*t.f+.001),o=100/(t.g*t.g+.001),r=1-t.h*t.h*t.h*.01,n=-t.i*t.i*t.i*1e-6,t.a||(p=.5-t.n/2,d=5e-5*-t.o),h=1+t.l*t.l*(t.l>0?-.9:10),a=0,c=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var i=this._params;return t=i.b*i.b*1e5,e=i.c*i.c*1e5,s=i.e*i.e*1e5+12,3*((t+e+s)/3|0)},this.synthWave=function(l,u){var f=this._params,m=1!=f.s||f.v,x=f.v*f.v*.1,w=1+3e-4*f.w,y=f.s*f.s*f.s*.1,b=1+1e-4*f.t,g=1!=f.s,q=f.x*f.x,S=f.g,k=f.q||f.r,G=f.r*f.r*f.r*.2,v=f.q*f.q*(f.q<0?-1020:1020),B=f.p?32+((1-f.p)*(1-f.p)*2e4|0):0,A=f.d,j=f.j/2,E=f.k*f.k*.01,I=f.a,R=t,V=1/t,M=1/e,K=1/s,F=5/(1+f.u*f.u*20)*(.01+y);F>.8&&(F=.8),F=1-F;for(var Z,D,Y,J,Q,T,L=!1,O=0,C=0,H=0,P=0,W=0,X=0,U=0,N=0,z=0,_=0,$=new Array(1024),tt=new Array(32),et=$.length;et--;)$[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;et<u;et++){if(L)return et;if(B&&++z>=B&&(z=0,this.reset()),c&&++a>=c&&(c=0,i*=h),r+=n,(i*=r)>o&&(i=o,S>0&&(L=!0)),D=i,j>0&&(_+=E,D*=1+Math.sin(_)*j),(D|=0)<8&&(D=8),I||((p+=d)<0?p=0:p>.5&&(p=.5)),++C>R)switch(C=0,++O){case 1:R=e;break;case 2:R=s}switch(O){case 0:H=C*V;break;case 1:H=1+2*(1-C*M)*A;break;case 2:H=1-C*K;break;case 3:H=0,L=!0}k&&((Y=0|(v+=G))<0?Y=-Y:Y>1023&&(Y=1023)),m&&w&&((x*=w)<1e-5?x=1e-5:x>.1&&(x=.1)),T=0;for(var st=8;st--;){if(++U>=D&&(U%=D,3==I))for(var it=tt.length;it--;)tt[it]=2*Math.random()-1;switch(I){case 0:Q=U/D<p?.5:-.5;break;case 1:Q=1-U/D*2;break;case 2:Q=.225*(((Q=1.27323954*(J=6.28318531*((J=U/D)>.5?J-1:J))+.405284735*J*J*(J<0?1:-1))<0?-1:1)*Q*Q-Q)+Q;break;case 3:Q=tt[Math.abs(32*U/D|0)]}m&&(Z=X,(y*=b)<0?y=0:y>.1&&(y=.1),g?(W+=(Q-X)*y,W*=F):(X=Q,W=0),P+=(X+=W)-Z,Q=P*=1-x),k&&($[N%1024]=Q,Q+=$[(N-Y+1024)%1024],N++),T+=Q}T*=.125*H*q,l[et]=T>=1?32767:T<=-1?-32768:32767*T|0}return u}}var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),s=new Uint8Array(4*((e+1)/2|0)+44),i=2*synth.synthWave(new Uint16Array(s.buffer,44),e),o=new Uint32Array(s.buffer,0,44);return o[0]=1179011410,o[1]=i+36,o[2]=1163280727,o[3]=544501094,o[4]=16,o[5]=65537,o[6]=44100,o[7]=88200,o[8]=1048578,o[9]=1635017060,o[10]=i,s.buffer},function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):e("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:t.TinyMusic={})}(this,function(t){function e(t){var s=t.split(r);this.frequency=e.getFrequency(s[0])||0,this.duration=e.getDuration(s[1])||0}function s(t,e,s){this.ac=t||new AudioContext,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,s||[])}var i=440*Math.pow(Math.pow(2,1/12),-9),o=/^[0-9.]+$/,r=/\s+/,n=/(\d+)/,h={};"B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb".split("|").forEach(function(t,e){t.split("-").forEach(function(t){h[t]=e})}),e.getFrequency=function(t){var e=t.split(n),s=h[e[0]],o=(e[1]||4)-4;return i*Math.pow(Math.pow(2,1/12),s)*Math.pow(2,o)},e.getDuration=function(t){return o.test(t)?parseFloat(t):t.toLowerCase().split("").reduce(function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)},0)},s.prototype.createFxNodes=function(){var t=[["bass",100],["mid",1e3],["treble",2500]],e=this.gain=this.ac.createGain();return t.forEach(function(t,s){(s=this[t[0]]=this.ac.createBiquadFilter()).type="peaking",s.frequency.value=t[1],e.connect(e=s)}.bind(this)),e.connect(this.ac.destination),this},s.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},s.prototype.createCustomWave=function(t,e){e||(e=t),this.waveType="custom",this.customWave=[new Float32Array(t),new Float32Array(e)]},s.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},s.prototype.scheduleNote=function(t,e){var s=60/this.tempo*this.notes[t].duration,i=s*(1-(this.staccato||0));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,i),this.setFrequency(0,e+i),e+s},s.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},s.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},s.prototype.slide=function(t,e,s){var i=this.getNextNote(t),o=this.getSlideStartDelay(s);return this.setFrequency(this.notes[t].frequency,e+o),this.rampFrequency(i.frequency,e+s),this},s.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},s.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},s.prototype.play=function(t){return t="number"==typeof t?t:this.ac.currentTime,this.createOscillator(),this.osc.start(t),this.notes.forEach(function(e,s){t=this.scheduleNote(s,t)}.bind(this)),this.osc.stop(t),this.osc.onended=this.loop?this.play.bind(this,t):null,this},s.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},t.Note=e,t.Sequence=s});var Game;!function(t){class e{constructor(t,e,s){this.pos=t,this.w=e,this.h=s}test(t){return this.pos.x<t.pos.x+t.w&&this.pos.x+this.w>t.pos.x&&this.pos.y<t.pos.y+t.h&&this.h+this.pos.y>t.pos.y}contains(t){return this.pos.x<=t.pos.x&&this.pos.x+this.w>=t.pos.x+t.w&&this.pos.y<=t.pos.y&&this.pos.y+this.h>=t.pos.y+t.h}intersect(s){let i=Math.round(this.pos.x),o=Math.round(this.pos.y),r=i+this.w,n=o+this.h,h=Math.round(s.pos.x),a=Math.round(s.pos.y),c=h+s.w,p=a+s.h,d=i<h?h:i,l=o<a?a:o,u=r<c?r:c,f=n<p?n:p;return new e(new t.Vec(d,l),u-d,f-l)}clone(){return new e(this.pos.clone(),this.w,this.h)}}t.Box=e}(Game||(Game={}));var Game;!function(t){class e{constructor(s,i,o){this.tick=0,this.frame=0,this.end=!1,this.color=i,this.box=new t.Box(s,16,16),o&&e.sfx.play()}render(t){this.frame<3&&e.sprite.render(t,this.box,this.color,this.frame)}update(t){this.tick++%4==0&&(this.end=++this.frame>2)}}t.Bumm=e}(Game||(Game={}));var Game;!function(t){class e{constructor(s,i,o){this.collided=new t.Vec(0,0),this.frame=0,this.tick=0,this.flip=t.Rand.get()<.5;let r=this.flip?240:0,n=Math.round(t.Rand.get(136))+32;this.box=new t.Box(new t.Vec(r,n),16,16),this.speed=new t.Vec(this.flip?-s:s,i),this.color=e.count++%4+1,this.type=o}render(t){let s=2*this.type;String(this.speed.x).charAt(0);this.flip&&null!==e.sprites[s+1]&&s++,e.sprites[s].render(t,this.box,this.color,3!=this.frame?this.frame:1)}update(t){this.tick++%7==0&&(this.frame=++this.frame%3)}}e.sprites=[],e.count=0,t.Enemy=e}(Game||(Game={}));var Game;!function(t){class e{constructor(e,s){this.face=0,this.lasers=[],this.jetSound=null,this.pos=new t.Vec(e,s),this.box=new t.Box(null,16,24),this.spawn()}spawn(e=-200){this.tick=e,this.walk=!0,this.pick=!1,this.face=0,this.frame=1,this.shoot=!1,this.speed=new t.Vec(0,1),this.collided=new t.Vec(0,1),this.box.pos=this.pos.clone()}mute(){this.jetSound&&(this.jetSound.stop(),this.jetSound=null)}inactive(){return this.tick<-100}spawning(){return this.tick<0}render(t){let s=this.box,i=this.frame;this.lasers.forEach(e=>{e.render(t)}),this.inactive()||(this.spawning()&&this.tick%30<-15&&(t.globalAlpha=.3),this.walk?(i=i<3?i:1,e.sprite.render(t,s,this.face,i+1)):e.sprite.render(t,s,this.face,0),this.walk||e.jetSprite.render(t,this.box,this.face+2,this.frame),t.globalAlpha=1)}update(t){t%8==0&&(this.shoot&&this.shot(),this.walk?0!=this.speed.x&&(this.frame=++this.frame%4):this.frame=++this.frame%3),this.walk&&this.mute(),this.walk||this.jetSound||(this.jetSound=e.jetSfx.play(.1,!0)),this.tick++}shot(){this.lasers.push(new t.Laser(this))}}t.Hero=e}(Game||(Game={}));var Game;!function(t){class e{constructor(s){this.collided=new t.Vec(0,0),this.speed=new t.Vec(-6,0),this.end=!1,this.add=5,this.width=112,this.tick=15;let i=s.box.clone(),o=i.pos;s.face?(this.speed.x=-this.speed.x,o.x+=i.w):o.x-=this.add,o.y+=12,i.h=1,i.w=this.add,this.box=i,this.color=Math.round(2*Math.random())+1,this.face=s.face,e.sfx.play(.5)}render(t){const s=this.box;this.face?e.sprite2.render(t,s,this.color,0,this.width-s.w):e.sprite1.render(t,s,this.color,0)}update(t){let e=this.box,s=--this.tick<0?-this.add:this.add;e.w+=s,this.face&&(e.pos.x-=s),this.end=e.w<=this.add}}t.Laser=e}(Game||(Game={}));var Game;!function(t){class e{constructor(){this.collided=new t.Vec(0,0),this.speed=new t.Vec(0,.5);let e=8*Math.round(30*Math.random());this.box=new t.Box(new t.Vec(e,16),16,12),this.type=Math.round(4*Math.random()),this.color=Math.round(2*Math.random())+1}render(t){e.sprite.render(t,this.box,this.color,this.type)}update(t){}}t.Loot=e}(Game||(Game={}));var Game;!function(t){class e{constructor(e,s,i,o=0){this.box=new t.Box(new t.Vec(e,s),i,8),this.color=o}render(t){if(this.color<0)return;let s=this.color,i=this.box.clone(),o=Math.round(i.w/8)-1;i.w=8,e.sprite.render(t,i,s,0);for(let r=1;r<o;r++)i.pos.x+=i.w,e.sprite.render(t,i,s,1);i.pos.x+=i.w,e.sprite.render(t,i,s,2)}}t.Platform=e}(Game||(Game={}));var Game;!function(t){class e{constructor(e,s=1,i=2){this.tick=1,this.hero=new t.Hero(96,160),this.loot=null,this.width=256,this.bumms=[];let o=Math.floor(e/4)%4;this.ship=e%4?new t.Ship(o,new t.Vec(160,-120)):new t.Ship(o,new t.Vec(160,136),new t.Vec(128,80),new t.Vec(48,56)),this.platforms=[new t.Platform(-50,8,350,-1),new t.Platform(32,72,48,s),new t.Platform(120,96,32,s),new t.Platform(192,48,48,s),new t.Platform(-50,184,350,i)]}complete(){return this.ship.gone()}ai(){this.enemies.items.forEach(t=>{t.collided.y&&(t.speed.y=-t.speed.y),t.collided.x&&(t.speed.x=-t.speed.x)})}back(e){if(this.cache)return void e.drawImage(this.cache,0,0);let s=e.createLinearGradient(0,0,0,192);s.addColorStop(0,"#002"),s.addColorStop(1,"#224"),e.fillStyle=s,e.fillRect(0,0,e.canvas.width,e.canvas.height),this.platforms.forEach(t=>{t.render(e)}),new t.Txt(new t.Vec(0,0),"Score").render(e),new t.Txt(new t.Vec(0,8),"00000000",1).render(e),new t.Txt(new t.Vec(120,0),"HP",2).render(e),new t.Txt(new t.Vec(120,8),"04",1).render(e),new t.Txt(new t.Vec(207,0),"Hi Score").render(e),new t.Txt(new t.Vec(207,8),"00000000",1).render(e),this.cache=new Image,this.cache.src=e.canvas.toDataURL()}render(t){this.back(t),this.ship.render(t),this.loot&&this.loot.render(t),this.ship.go()||this.hero.render(t),this.enemies.render(t),this.bumms.forEach(e=>{e.render(t)})}input(t,e){const s=this.hero;s.inactive()||(s.shoot=e.shiftKey,s.speed.y=t[38]||t[87]||t[119]?-1:1,t[37]||t[65]||t[97]?(s.speed.x=-1,s.face=0):t[39]||t[68]||t[100]?(s.speed.x=1,s.face=1):s.speed.x=0)}update(){this.updateHero(),this.updateShip(),this.updateLoot(),this.updateEnemies(),this.updateBumms(),this.tick++}updateShip(){let e=this.ship,s=this.hero;if(e.update(this.tick),e.ready()&&e.box.contains(s.box)&&(e.status++,t.Ship.goSfx.play(),s.mute()),e.go()||!e.land())return;let i=e.complete(),o=e.parts[i?0:e.status-1],r=i?e.fuel:e.parts[e.status],n=Math.abs(o.box.pos.x-r.box.pos.x);if(this.move(r),n<1)s.pick=!1,r.box.pos.x=o.box.pos.x,r.box.test(o.box)&&(i?e.fuel=new t.Fuel:r.box.pos=o.box.pos.clone().sub(0,r.box.h),e.status++,t.Ship.buildSfx.play());else if(!s.inactive()&&!e.ready()){let e=s.box.clone(),i=r.box.pos,o=this.width,n=e.test(r.box);n||(e.pos.x-=o,n=e.test(r.box)),n||(e.pos.x+=2*o,n=e.test(r.box)),n&&(s.pick||(t.Hero.pickSfx.play(),s.pick=!0),i.add(e.pos.add(0,8).sub(i).scale(.2)),i.x<0?i.x+=o:i.x>o&&(i.x-=o))}}updateHero(){let t=this.hero,e=this.ship;if(!e.land()||e.go())return;this.move(t);let s=t.collided.y&&t.speed.y>0;t.walk&&!s&&this.addBumm(t.box.pos.clone().add(t.face?-8:8,12),0,!1),t.walk=s,this.hero.update(this.tick);let i=0;for(;i<t.lasers.length;){let e=t.lasers[i];this.updateLaser(e),e.end?t.lasers.splice(i,1):i++}}updateLaser(t){let e=t.box.pos;if(e.x+=t.speed.x,e.x>this.width?e.x-=this.width:e.x<0&&(e.x+=this.width),t.update(this.tick),t.end)return;let s=0,i=this.enemies.items;for(;s<i.length;){let e=i[s];this.collide(t,e)?(i.splice(s,1),this.addBumm(e.box.pos.clone())):s++}}updateLoot(){if(null===this.loot)return void(this.tick%1e3==0&&(this.loot=new t.Loot));let e=this.loot;this.move(e),e.update(this.tick),!this.ship.go()&&this.collide(e,this.hero)&&(t.Loot.sfx.play(),this.loot=null)}updateEnemies(){let t=this.hero,e=this.enemies;e.items.forEach(t=>{this.move(t)}),this.ai(),t.spawning()||this.ship.go()||e.items.forEach(e=>{this.collide(t,e)&&(this.addBumm(t.box.pos.clone()),this.addBumm(t.box.pos.clone().add(0,8),1,!1),t.spawn())}),e.update(this.tick)}addBumm(e,s=1,i=!0){this.bumms.push(new t.Bumm(e,s,i))}updateBumms(){let t=0;for(;t<this.bumms.length;){let e=this.bumms[t];e.update(this),e.end?this.bumms.splice(t,1):t++}}collide(t,s){let i=e.sprite.ictx,o=this.width,r=t.box.clone(),n=s.box.clone(),h=!1;if(!r.test(n)&&(r.pos.x+r.w>o&&(r.pos.x-=o,h=!0),n.pos.x+n.w>o&&(n.pos.x-=o,h=!0),!h||!r.test(n)))return!1;let a=r.intersect(n),c=a.pos.x,p=a.pos.y,d=a.w+1,l=a.h+1;i.clearRect(c,p,d,l),t.render(i);let u=i.getImageData(c,p,d,l);i.clearRect(c,p,d,l),s.render(i);let f=i.getImageData(c,p,d,l),m=u.data.length;for(let t=3;t<m;t+=20)if(u.data[t]&&f.data[t])return!0;return!1}move(t){let e=t.collided,s=t.speed,i=t.box.pos,o=i.clone();e.x=0,e.y=0,s.x&&(i.x+=s.x,i.x>this.width?i.x-=this.width:i.x<0&&(i.x+=this.width),this.platforms.forEach(s=>{s.box.test(t.box)&&(i.x=o.x,e.x=1)})),s.y&&(i.y+=s.y,this.platforms.forEach(s=>{s.box.test(t.box)&&(i.y=o.y,e.y=1)}))}}t.Scene=e;class s extends e{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.5,t.Rand.get()/2-.25,0))}ai(){let t=0,e=this.enemies.items;for(;t<e.length;){let s=e[t];s.collided.x||s.collided.y?(this.addBumm(s.box.pos),e.splice(t,1)):t++}}}t.Scene0=s;class i extends e{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.5,t.Rand.get()<.5?-.5:.5,7))}}t.Scene1=i;class o extends e{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.5,0,6))}ai(){super.ai(),this.enemies.items.forEach(e=>{e.tick%64==0&&(e.speed.y=(Math.round(2*t.Rand.get())-1)/2)})}}t.Scene2=o;class r extends e{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(0,0,1))}ai(){let t=0,e=this.hero,s=this.enemies.items;for(;t<s.length;){let i=s[t];i.tick%80==0&&0==i.speed.x&&(i.speed=e.box.pos.clone().sub(i.box.pos).normalize()),i.collided.x||i.collided.y?(this.addBumm(i.box.pos),s.splice(t,1)):t++}}}t.Scene3=r;class n extends e{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.5,-.5,4))}ai(){this.enemies.items.forEach(t=>{let e=this.hero;t.tick%80!=0||e.inactive()||(t.speed=e.box.pos.clone().sub(t.box.pos).normalize().scale(.7))})}}t.Scene4=n;class h extends e{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.5,t.Rand.get()<.5?-.7:.7,5))}}t.Scene5=h;class a extends s{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.7,t.Rand.get()/2-.25,2))}}t.Scene6=a;class c extends n{constructor(e){super(e),this.enemies=new t.Spawner(()=>new t.Enemy(.5,-.5,3))}}t.Scene7=c}(Game||(Game={}));var Game;!function(t){class e{constructor(t){e.load++;const s=jsfxr(t);e.ctx||(e.ctx=new AudioContext,e.master=e.ctx.createGain(),e.master.connect(e.ctx.destination)),e.ctx.decodeAudioData(s,t=>{this.buffer=t,e.loaded++})}static ready(){return e.load==e.loaded}play(t=1,s=!1){const i=e.ctx.createGain(),o=e.ctx.createBufferSource();return i.connect(e.master),i.gain.value=t,o.loop=s,o.buffer=this.buffer,o.connect(i),o.start(e.ctx.currentTime),o}}e.load=0,e.loaded=0,t.Sfx=e}(Game||(Game={}));var Game;!function(t){class e{constructor(e,s){this.collided=new t.Vec(0,0),this.speed=new t.Vec(0,.5),this.box=new t.Box(e,16,16),this.top=s}render(t){}update(t){}}class s{constructor(){this.collided=new t.Vec(0,0),this.speed=new t.Vec(0,.5);let e=8*Math.round(30*Math.random());this.box=new t.Box(new t.Vec(e,16),16,12)}render(t){s.sprite.render(t,this.box,1,0)}update(t){}}t.Fuel=s;class i{constructor(o,r,n=null,h=null){this.collided=new t.Vec(0,0),this.speed=new t.Vec(0,-1),this.fuel=new s,this.fuels=6,this.tick=0,this.box=new t.Box(r,16,48),n?this.status=1:(this.status=3,i.landSfx.play()),this.parts=[new e(r.clone().add(0,32),2),new e(n||r.clone().add(0,16),1),new e(h||r.clone(),0)],this.type=o}complete(){return this.status>=this.parts.length}ready(){return this.status==this.parts.length+this.fuels}land(){return 136==this.box.pos.y}go(){return this.status>this.parts.length+this.fuels}gone(){return this.go()&&this.box.pos.y<=-120}render(t){let e=this.type;if(this.ready()||this.go())i.sprite.render(t,this.box,Math.floor(this.tick%4/2),e);else if(this.complete()){let s=this.box.clone(),o=this.fuels,r=o-(this.status-this.parts.length);s.h/=o;for(let n=0;n<o;n++){let h=r>n?n:n+o;i.sprite.render(t,s,h,e),s.pos.y+=s.h}this.land()&&this.fuel.render(t)}else this.parts.forEach((s,o)=>{i.sprite.render(t,s.box,s.top,e)});if(!this.land()||this.go()){let e=this.box.clone();e.pos.y+=e.h,e.h=16,i.jetSprite.render(t,e,1,this.tick%3)}}update(t){t%8==0&&this.tick++,this.go()?this.box.pos.add(this.speed):this.land()||(this.box.pos.sub(this.speed),this.parts[0].box.pos.sub(this.speed))}}t.Ship=i}(Game||(Game={}));var Game;!function(t){class e{constructor(t,e=64,s=4){this.items=[],this.index=0,this.freq=e,this.limit=s,this.factory=t}update(t){if(t%this.freq==0&&this.items.length<this.limit){const t=this.factory.call(this,this.index++);this.items.push(t)}this.items.forEach(e=>{e.update(t)})}render(t){this.items.forEach(e=>{e.render(t)})}}t.Spawner=e}(Game||(Game={}));var Game;!function(t){class e{constructor(t,s,i,o=null){e.load++,this.img=new Image,this.img.onload=(()=>{e.loaded++,o&&o.call(this)}),this.img.src=s,this.ictx=t,this.width=i}static ready(){return e.load==e.loaded}render(t,e,s,i,o=0){let r=e.pos,n=Math.round(r.x),h=Math.round(r.y),a=e.w,c=e.h;s*=c,o+=a*i,t.drawImage(this.img,o,s,a,c,n,h,a,c),n+a>this.width&&t.drawImage(this.img,o,s,a,c,n-this.width,h,a,c)}crop(t,s,i,o,r=[],n=!1,h=!1){let a=this.ictx,c=a.canvas,p=c.width,d=c.height,l=r.length,u=r.map(t=>{const e=[0,0,0,0];for(let s=0;s<t.length;s++){let i=parseInt(t.substr(s,1),16);e[s]=16*i+i}return e});if(c.width=i,c.height=o*(l+1),a.save(),a.translate(n?i:0,h?o:0),a.scale(n?-1:1,h?-1:1),a.drawImage(this.img,t,s,i,o,0,0,i,o),a.restore(),l>0){const t=a.getImageData(0,0,c.width,c.height),e=t.data.length/(l+1);for(let s=0;s<e;s+=4)if(t.data[s+3])for(let i=0;i<4;i++)for(let o=0;o<l;o++){let n=t.data[s+i];r[o].length>i&&(n-=255-u[o][i]);let h=(o+1)*e+s+i;t.data[h]=n>0?n:0}a.putImageData(t,0,0)}const f=new e(a,c.toDataURL(),this.width);return c.width=p,c.height=d,f}}e.load=0,e.loaded=0,t.Sprite=e}(Game||(Game={}));var Game;!function(t){class e{constructor(e,s,i=0){this.box=new t.Box(e,6,7),this.text=s,this.color=i}render(t){let s=this.box.clone();for(let i=0;i<this.text.length;i++){let o=this.text.charCodeAt(i),r=2*this.color;o>=48&&o<=57&&e.sprite.render(t,s,r,o-48),o>=97&&o<=122&&(o-=32),o>=65&&o<=90&&((o-=55)>=18&&(o-=18,r++),e.sprite.render(t,s,r,o)),s.pos.x+=s.w}}}t.Txt=e}(Game||(Game={}));var Game;!function(t){class e{constructor(t,e){this.x=t,this.y=e}clone(){return new e(this.x,this.y)}add(t,s){return t instanceof e?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=s),this}sub(t,s){return t instanceof e?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=s),this}scale(t){return this.x*=t,this.y*=t,this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){var t=this.length();return t>0&&this.scale(1/t),this}}t.Vec=e}(Game||(Game={}));var Game;!function(t){function e(t,e){return(e||document).querySelector(t)}function s(t,e,s){t.addEventListener(e,s,!1)}function i(){let t=document.body,e=t.clientWidth/t.clientHeight<h.width/h.height;h.style.width=e?"100%":"",h.style.height=e?"":"100%"}function o(){const t={};s(document,"keydown",e=>{t[e.keyCode]=!0,c&&c.input(t,e)}),s(document,"keyup",e=>{t[e.keyCode]=!1,c&&c.input(t,e)}),s(window,"resize",i)}function r(){if(requestAnimationFrame(()=>{r()}),t.Sprite.ready()&&t.Sfx.ready()){if(!c||c.complete()){switch(p%8){case 1:c=new t.Scene1(p);break;case 2:c=new t.Scene2(p);break;case 3:c=new t.Scene3(p);break;case 4:c=new t.Scene4(p);break;case 5:c=new t.Scene5(p);break;case 6:c=new t.Scene6(p);break;case 7:c=new t.Scene7(p);break;default:c=new t.Scene0(p)}p++}c.update(),c.render(a)}}class n{static get(t=1,e=0){return n.seed=(9301*n.seed+49297)%233280,e+n.seed/233280*(t-e)}}n.seed=Math.round(1e3*Math.random()),t.Rand=n;let h,a,c,p;s(window,"load",()=>{h=e("#game"),a=h.getContext("2d"),p=parseInt(location.hash.replace(/#/,""))||0;const s=e("#test").getContext("2d"),n=new t.Sprite(s,"data:image/gif;base64,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",h.width,()=>{t.Scene.sprite=n,t.Hero.sprite=n.crop(0,0,64,48),t.Hero.jetSprite=n.crop(64,0,48,48,["fc0"]),t.Bumm.sprite=n.crop(0,152,48,16,["fc0"]),t.Platform.sprite=n.crop(0,80,24,8,["0c0","fc0"]),t.Laser.sprite1=n.crop(0,180,112,1,["f6f","f66","6ff"]),t.Laser.sprite2=n.crop(0,180,112,1,["f6f","f66","6ff"],!0),t.Loot.sprite=n.crop(16,168,80,12,["f0f","0ff","ff0"]),t.Fuel.sprite=n.crop(0,168,16,12,["f0f"]),t.Ship.sprite=n.crop(0,88,64,48,["f6f"]),t.Ship.jetSprite=n.crop(0,136,48,16,["fc0"]),t.Txt.sprite=n.crop(0,181,108,14,["ff0","0ff"]),t.Hero.jetSfx=new t.Sfx([3,,1,,,.61,,1,1,,,-1,,,-1,,-.76,-.02,.456,0,.18,,-1,.5]),t.Hero.pickSfx=new t.Sfx([0,,.09,.37,.18,.47,,,,,,.42,.67,,,,,,1,,,,,.5]),t.Bumm.sfx=new t.Sfx([3,,.38,.47,.29,.09,,,,,,,,,,.55,.34,-.13,1,,,,,.5]),t.Laser.sfx=new t.Sfx([0,,.12,,.16,.3,.2,-.17,,,,,,.55,-.45,,,,1,,,,,.5]),t.Loot.sfx=new t.Sfx([0,,.11,,.19,.23,,.46,,,,,,.44,,.53,,,1,,,,,.5]),t.Ship.goSfx=new t.Sfx([3,,1,,1,.14,,.08,,,,,,,,,,,1,,,,,.5]),t.Ship.landSfx=new t.Sfx([3,,1,,1,.2,,.08,-.05,,,,,,,,,,1,,,,,.5]),t.Ship.buildSfx=new t.Sfx([0,,.07,.55,.1,.54,,,,,,.35,.69,,,,,,1,,,,,.5]);for(let e=48;e<=64;e+=16)t.Enemy.sprites.push(n.crop(0,e,48,16,["f66","f6f","66f","6ff"]),n.crop(0,e,48,16,["f66","f6f","66f","6ff"],!0));for(let e=48;e<=128;e+=16)t.Enemy.sprites.push(n.crop(64,e,48,16,["f66","f6f","66f","6ff"]),null);i(),o(),r()})})}(Game||(Game={}));