function SfxrParams(){this.setSettings=function(e){for(var t=0;t<24;t++)this[String.fromCharCode(97+t)]=e[t]||0;this.c<.01&&(this.c=.01);var s=this.b+this.c+this.e;if(s<.18){var i=.18/s;this.b*=i,this.c*=i,this.e*=i}}}function SfxrSynth(){this._params=new SfxrParams;var e,t,s,i,r,h,a,n,o,c,d,w;this.reset=function(){var e=this._params;i=100/(e.f*e.f+.001),r=100/(e.g*e.g+.001),h=1-e.h*e.h*e.h*.01,a=-e.i*e.i*e.i*1e-6,e.a||(d=.5-e.n/2,w=5e-5*-e.o),n=1+e.l*e.l*(e.l>0?-.9:10),o=0,c=1==e.m?0:(1-e.m)*(1-e.m)*2e4+32},this.totalReset=function(){this.reset();var i=this._params;return e=i.b*i.b*1e5,t=i.c*i.c*1e5,s=i.e*i.e*1e5+12,3*((e+t+s)/3|0)},this.synthWave=function(m,f){var l=this._params,p=1!=l.s||l.v,u=l.v*l.v*.1,x=1+3e-4*l.w,y=l.s*l.s*l.s*.1,v=1+1e-4*l.t,b=1!=l.s,g=l.x*l.x,G=l.g,k=l.q||l.r,S=l.r*l.r*l.r*.2,V=l.q*l.q*(l.q<0?-1020:1020),E=l.p?32+((1-l.p)*(1-l.p)*2e4|0):0,M=l.d,P=l.j/2,q=l.k*l.k*.01,B=l.a,C=e,A=1/e,I=1/t,R=1/s,j=5/(1+l.u*l.u*20)*(.01+y);j>.8&&(j=.8),j=1-j;for(var U,L,_,H,W,D,z=!1,F=0,J=0,K=0,N=0,O=0,Q=0,T=0,X=0,Y=0,Z=0,$=new Array(1024),ee=new Array(32),te=$.length;te--;)$[te]=0;for(te=ee.length;te--;)ee[te]=2*Math.random()-1;for(te=0;te<f;te++){if(z)return te;if(E&&++Y>=E&&(Y=0,this.reset()),c&&++o>=c&&(c=0,i*=n),h+=a,(i*=h)>r&&(i=r,G>0&&(z=!0)),L=i,P>0&&(Z+=q,L*=1+Math.sin(Z)*P),(L|=0)<8&&(L=8),B||((d+=w)<0?d=0:d>.5&&(d=.5)),++J>C)switch(J=0,++F){case 1:C=t;break;case 2:C=s}switch(F){case 0:K=J*A;break;case 1:K=1+2*(1-J*I)*M;break;case 2:K=1-J*R;break;case 3:K=0,z=!0}k&&((_=0|(V+=S))<0?_=-_:_>1023&&(_=1023)),p&&x&&((u*=x)<1e-5?u=1e-5:u>.1&&(u=.1)),D=0;for(var se=8;se--;){if(++T>=L&&(T%=L,3==B))for(var ie=ee.length;ie--;)ee[ie]=2*Math.random()-1;switch(B){case 0:W=T/L<d?.5:-.5;break;case 1:W=1-T/L*2;break;case 2:W=.225*(((W=1.27323954*(H=6.28318531*((H=T/L)>.5?H-1:H))+.405284735*H*H*(H<0?1:-1))<0?-1:1)*W*W-W)+W;break;case 3:W=ee[Math.abs(32*T/L|0)]}p&&(U=Q,(y*=v)<0?y=0:y>.1&&(y=.1),b?(O+=(W-Q)*y,O*=j):(Q=W,O=0),N+=(Q+=O)-U,W=N*=1-u),k&&($[X%1024]=W,W+=$[(X-_+1024)%1024],X++),D+=W}D*=.125*K*g,m[te]=D>=1?32767:D<=-1?-32768:32767*D|0}return f}}var synth=new SfxrSynth,jsfxr=function(e){synth._params.setSettings(e);var t=synth.totalReset(),s=new Uint8Array(4*((t+1)/2|0)+44),i=2*synth.synthWave(new Uint16Array(s.buffer,44),t),r=new Uint32Array(s.buffer,0,44);r[0]=1179011410,r[1]=i+36,r[2]=1163280727,r[3]=544501094,r[4]=16,r[5]=65537,r[6]=44100,r[7]=88200,r[8]=1048578,r[9]=1635017060,r[10]=i,i+=44;for(var h=0,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="data:audio/wav;base64,";h<i;h+=3){var o=s[h]<<16|s[h+1]<<8|s[h+2];n+=a[o>>18]+a[o>>12&63]+a[o>>6&63]+a[63&o]}return n};"function"==typeof require?module.exports=jsfxr:this.jsfxr=jsfxr;var Game;!function(e){class t{constructor(e,t,s){this.pos=e,this.w=t,this.h=s}test(e){return this.pos.x<e.pos.x+e.w&&this.pos.x+this.w>e.pos.x&&this.pos.y<e.pos.y+e.h&&this.h+this.pos.y>e.pos.y}intersect(s){let i=this.pos.x,r=this.pos.y,h=i+this.w,a=r+this.h,n=s.pos.x,o=s.pos.y,c=n+s.w,d=o+s.h,w=i<n?n:i,m=r<o?o:r,f=h<c?h:c,l=a<d?a:d;return new t(new e.Vec(w,m),f-w,l-m)}clone(){return new t(this.pos.clone(),this.w,this.h)}}e.Box=t}(Game||(Game={}));var Game;!function(e){class t{constructor(t,s,i){this.collided=new e.Vec(0,0),this.frame=0,this.walk=!1,this.box=new e.Box(t,16,16),this.speed=s,this.sprite=i}render(e){this.sprite.render(e,this.box,0,3!=this.frame?this.frame:1)}update(e){e%8==0&&(this.frame=++this.frame%3),this.collided.y&&(this.speed.y=-this.speed.y),this.collided.x&&(this.speed.x=-this.speed.x)}}e.Enemy=t}(Game||(Game={}));var Game;!function(e){class t{constructor(t,s,i){this.collided=new e.Vec(0,0),this.face=0,this.walk=!0,this.frame=1,this.sprite=i,this.speed=new e.Vec(0,1),this.box=new e.Box(new e.Vec(t,s),16,24)}render(e){let t=this.box.clone(),s=t.pos,i=(s.x,s.y,t.w,t.h),r=this.face*i,h=this.walk,a=this.frame,n=this.sprite;h?(a=a<3?a:1,n.render(e,t,r,a+1)):(n.render(e,t,r,0),n.render(e,t,r,a+4))}update(e){e%8==0&&(this.walk?0!=this.speed.x&&(this.frame=++this.frame%4):this.frame=++this.frame%3)}}e.Hero=t}(Game||(Game={}));var Game;!function(e){class t{constructor(t,s,i,r){this.box=new e.Box(new e.Vec(t,s),i,r)}render(e,t){const s=this.box;e.fillStyle="#0ff",e.fillRect(s.pos.x,s.pos.y,s.w,s.h)}}e.Platform=t}(Game||(Game={}));var Game;!function(e){class t{constructor(t,s){this.tick=0,this.width=256,this.sprite=new e.Sprite(s,this.width),this.hero=new e.Hero(96,160,this.sprite.crop(t,0,0,112,48)),this.ship=new e.Ship(160,136,this.sprite.crop(t,0,88,48,48)),this.platforms=[new e.Platform(-50,0,350,16),new e.Platform(32,72,48,8),new e.Platform(120,96,32,8),new e.Platform(192,48,48,8),new e.Platform(-50,184,350,8)];let i=this.sprite.crop(t,0,48,48,16),r=new e.Vec(.5,-.5);this.enemies=[new e.Enemy(new e.Vec(0,20),r.clone(),i),new e.Enemy(new e.Vec(0,60),r.clone(),i),new e.Enemy(new e.Vec(0,100),r.clone(),i),new e.Enemy(new e.Vec(0,140),r.clone(),i)]}back(e){if(this.cache)return void e.drawImage(this.cache,0,0);let t=e.createLinearGradient(0,0,0,192);t.addColorStop(0,"#002"),t.addColorStop(1,"#224"),e.fillStyle=t,e.fillRect(0,0,e.canvas.width,e.canvas.height);for(let t=1;t<this.platforms.length;t++){let s=this.platforms[t].box.clone(),i=Math.round(s.w/8)-1;s.w=8,this.sprite.render(e,s,80,0);for(let t=1;t<i;t++)s.pos.x+=s.w,this.sprite.render(e,s,80,1);s.pos.x+=s.w,this.sprite.render(e,s,80,2)}this.cache=new Image,this.cache.src=e.canvas.toDataURL()}render(e){this.back(e),this.ship.render(e),this.hero.render(e),this.enemies.forEach(t=>{t.render(e)})}update(){this.hero.update(this.tick),this.move(this.hero),this.enemies.forEach(e=>{e.update(this.tick),this.move(e)}),this.tick++}move(e){let t=e.collided,s=e.speed,i=e.box.pos,r=i.clone(),h=!1;i.x+=s.x,i.x>this.width?i.x-=this.width:i.x<0&&(i.x+=this.width),t.x=0,this.platforms.forEach(s=>{s.box.test(e.box)&&(i.x=r.x,t.x=1)}),i.y+=s.y,t.y=0,this.platforms.forEach(a=>{a.box.test(e.box)&&(i.y=r.y,t.y=1,s.y>0&&(h=!0))}),e.walk=h}}e.Scene=t}(Game||(Game={}));var Game;!function(e){class t{constructor(t,s,i){this.sprite=i,this.boxes=[new e.Box(new e.Vec(t,s),16,16),new e.Box(new e.Vec(t,s+16),16,16),new e.Box(new e.Vec(t,s+32),16,16)]}render(e){this.boxes.forEach((t,s)=>{this.sprite.render(e,t,t.h*s,0)})}}e.Ship=t}(Game||(Game={}));var Game;!function(e){class t{constructor(e,t){this.img=e,this.width=t}render(e,t,s,i){let r=t.pos,h=Math.round(r.x),a=Math.round(r.y),n=Math.round(t.w),o=Math.round(t.h);e.drawImage(this.img,n*i,s,n,o,h,a,n,o),h+n>this.width&&e.drawImage(this.img,n*i,s,n,o,h-this.width,a,n,o)}crop(e,s,i,r,h,a=!1,n=!1){let o=new Image,c=e.canvas,d=c.width,w=c.height;return c.width=r,c.height=h,e.save(),e.translate(a?r:0,n?h:0),e.scale(a?-1:1,n?-1:1),e.drawImage(this.img,-s,-i),e.restore(),o.src=c.toDataURL(),c.width=d,c.height=w,new t(o,this.width)}}e.Sprite=t}(Game||(Game={}));var Game;!function(e){class t{constructor(e,t){this.x=e,this.y=t}clone(){return new t(this.x,this.y)}}e.Vec=t}(Game||(Game={}));var Game;!function(e){function t(e,t){return(t||document).querySelector(e)}function s(e,t,s){e.addEventListener(t,s,!1)}function i(){let e=document.body,t=e.clientWidth/e.clientHeight<a.width/a.height;a.style.width=t?"100%":"",a.style.height=t?"":"100%"}function r(){const e=o.hero;s(document,"keydown",t=>{let s=t.keyCode;38==s||87==s||119==s?e.speed.y=-1:37==s||65==s||97==s?(e.speed.x=-1,e.face=0):39!=s&&68!=s&&100!=s||(e.speed.x=1,e.face=1)}),s(document,"keyup",t=>{let s=t.keyCode;38==s||87==s||119==s||40==s||83==s||115==s?e.speed.y=1:37!=s&&65!=s&&97!=s&&39!=s&&68!=s&&100!=s||(e.speed.x=0)}),s(window,"resize",i)}function h(){requestAnimationFrame(()=>{h()}),o.update(),o.render(n)}let a,n,o;s(window,"load",()=>{const s=t("#sprite");a=t("#game"),n=a.getContext("2d"),o=new e.Scene(n,s),r(),i(),h()})}(Game||(Game={}));